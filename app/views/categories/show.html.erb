<% provide(:title, @category.name) %>

<div class="breadcrub" data-no-turbolink>
  <%= link_to "http://gaswarnanlagen.com", root_path %> > <%= link_to( @category.parent.name, @category.parent ) + " > " if @category.parent %><%= @category.name %>
  </div>

<div class="row">
  <% if current_user && current_user.admin? %>
    <p class="text-right">
  <%= link_to 'Kategorie barbeiten', edit_category_path(@category), class: "btn btn-large btn-primary" %>
  </p>
  <% end %>
</div>


<% if @category.attached_assets && @category.attached_assets.size == 1 %>
  <%= image_tag @category.attached_assets.first.asset_file_name if @category.attached_assets.first.asset_content_type.match( /\Aimage\/.*\Z/ ) %>
<% end %>


<% if @category.attached_assets && @category.attached_assets.size > 1 %>
<div id="category_images_carousel" class="carousel slide" data-ride="carousel" style="height: 400px">
  <!-- Indicators -->
  <ol class="carousel-indicators">
    <% @category.attached_assets.each_with_index do |asset, index| %>
    <li data-target="#category_images_carousel" data-slide-to="<%= 0 + index %>" class="<%= 'active' if index == 0 %>"></li>
    <% end %>
  </ol>

  <!-- Wrapper for slides -->
  <div class="carousel-inner" style="width:100%; max-height: 400px !important;">
  <% @category.attached_assets.each_with_index do |asset, index| %>
    <div class="item <%= 'active' if index == 0 %>">
      <%= image_tag asset.asset_file_name, style: "width: 100%; display: block; "  if asset.asset_content_type.match( /\Aimage\/.*\Z/ ) %>
    </div>
  <% end %>
  </div>

  <!-- Controls -->
  <a class="left carousel-control" href="#category_images_carousel" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left"></span>
  </a>
  <a class="right carousel-control" href="#category_images_carousel" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right"></span>
  </a>
</div>
<% end %>



<!-- Categories -->
<% unless @category.children.empty? %>
<div class="my-container">
  <div class="row">
    <div class="col-md-12">
      <div class="row">
      <% @category.children.order(:id).each do |child| %>
        <div class="col-md-3">
          <div class="my-inner box_category_small" style="background-color: <%= child.background_color %>">
            <a href="<%= category_path(child) %>"><h1><%= child.name %><i class="pull-right fa fa-chevron-down"></i></h1></a>
            <a href="<%= category_path(child) %>"><p class="logo"><%= image_tag child.logo.url %></p></a>
            <p class="description"><%= child.description %></p>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
<% end %>


<!-- Products -->
<% if @products.present? %>
<div class="row">
  <%= will_paginate @products, renderer: BootstrapPagination::Rails %>
</div>
<div class="table-responsive">
  <table class="table table-hover table-hover">
    <tr><th>Art. Nr.</th><th>Bezeichnung</th><th>Kurztext</th></tr>
    <%= render @products %>
  </table>
</div>
<div class="row">
  <%= will_paginate @products, renderer: BootstrapPagination::Rails %>
</div>
<% end %>


